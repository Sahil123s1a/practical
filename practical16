#include <iostream>
#include <stack>
#include <string>
using namespace std;

struct Node {
    char data;
    Node *left, *right;
    Node(char v) : data(v), left(nullptr), right(nullptr) {}
};

bool isOp(char c) { return c=='+'||c=='-'||c=='*'||c=='/'||c=='^'; }

Node* build(string pre) {
    stack<Node*> st;
    for (int i = pre.size()-1; i >= 0; i--) {
        Node* n = new Node(pre[i]);
        if (isOp(pre[i])) {
            Node* l = st.top(); st.pop();
            Node* r = st.top(); st.pop();
            n->left = l; n->right = r;
        }
        st.push(n);
    }
    return st.top();
}

void post(Node* r) {
    if (!r) return;
    stack<Node*> s1, s2;
    s1.push(r);
    while (!s1.empty()) {
        Node* c = s1.top(); s1.pop(); s2.push(c);
        if (c->left) s1.push(c->left);
        if (c->right) s1.push(c->right);
    }
    while (!s2.empty()) { cout << s2.top()->data; s2.pop(); }
    cout << endl;
}

void del(Node* r) {
    if (!r) return;
    stack<Node*> s1, s2;
    s1.push(r);
    while (!s1.empty()) {
        Node* c = s1.top(); s1.pop(); s2.push(c);
        if (c->left) s1.push(c->left);
        if (c->right) s1.push(c->right);
    }
    while (!s2.empty()) { delete s2.top(); s2.pop(); }
}

int main() {
    string pre = "+--a*bc/def";
    Node* root = build(pre);
    post(root);
    del(root);
}
